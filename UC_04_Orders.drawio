<mxfile host="app.diagrams.net">
  <diagram name="Order Management Use Cases" id="order-uc">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="4000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="ðŸ“¦ QUáº¢N LÃ ÄÆ N HÃ€NG (ORDER MANAGEMENT)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1;fontColor=#7F00FF;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="1320" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="subtitle" value="7 Use Cases: UC19-UC25 | Create, View, Cancel, Update Orders" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="40" y="90" width="1320" height="30" as="geometry" />
        </mxCell>

        <!-- UC19: Táº¡o Ä‘Æ¡n hÃ ng -->
        <mxCell id="uc19-section" value="UC19: Táº O ÄÆ N HÃ€NG" style="rounded=1;whiteSpace=wrap;html=1;fontSize=18;fontStyle=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="150" width="1320" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="uc19-info" value="&lt;table border=&quot;1&quot; width=&quot;100%&quot; cellpadding=&quot;10&quot; style=&quot;border-collapse: collapse; font-size:13px;&quot;&gt;&lt;tr style=&quot;background-color:#f0f0f0;&quot;&gt;&lt;td width=&quot;25%&quot; style=&quot;font-weight:bold;&quot;&gt;Use case name&lt;/td&gt;&lt;td&gt;Táº¡o Ä‘Æ¡n hÃ ng&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#f0f0f0;font-weight:bold;&quot;&gt;Actors&lt;/td&gt;&lt;td&gt;KhÃ¡ch hÃ ng&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#f0f0f0;font-weight:bold;vertical-align:top;&quot;&gt;Flow&lt;/td&gt;&lt;td style=&quot;text-align:left;&quot;&gt;&lt;b&gt;1.&lt;/b&gt; Nháº¥n &quot;Äáº·t hÃ ng&quot;&lt;br&gt;&lt;b&gt;2.&lt;/b&gt; Há»‡ thá»‘ng kiá»ƒm tra giá» hÃ ng&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.1 Láº¥y táº¥t cáº£ cart items cá»§a user&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.2 Kiá»ƒm tra giá» hÃ ng khÃ´ng rá»—ng&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.3 Kiá»ƒm tra tá»“n kho cho tá»«ng sáº£n pháº©m&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.4 Táº¡o order má»›i (status: PENDING)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.5 Táº¡o order_items tá»« cart_items&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.6 TÃ­nh subtotal, shipping fee, tax&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.7 Cáº­p nháº­t tá»“n kho (trá»« Ä‘i sá»‘ lÆ°á»£ng Ä‘áº·t)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.8 XÃ³a giá» hÃ ng&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.9 Gá»­i email xÃ¡c nháº­n (Observer Pattern)&lt;br&gt;&lt;b&gt;3.&lt;/b&gt; Tráº£ vá» thÃ´ng tin Ä‘Æ¡n hÃ ng&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" style="text;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="190" width="1320" height="260" as="geometry" />
        </mxCell>

        <mxCell id="uc19-scenarios-title" value="Ká»‹ch báº£n (Scenarios)" style="rounded=0;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="460" width="1320" height="30" as="geometry" />
        </mxCell>

        <mxCell id="uc19-scenarios" value="&lt;table border=&quot;1&quot; width=&quot;100%&quot; cellpadding=&quot;10&quot; style=&quot;border-collapse: collapse; font-size:13px;&quot;&gt;&lt;tr style=&quot;background-color:#d5e8d4;&quot;&gt;&lt;td width=&quot;30%&quot; style=&quot;font-weight:bold;&quot;&gt;Ká»‹ch báº£n&lt;/td&gt;&lt;td style=&quot;font-weight:bold;&quot;&gt;MÃ´ táº£&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#fff2cc;&quot;&gt;&lt;b&gt;Ká»‹ch báº£n 1: Giá» hÃ ng trá»‘ng&lt;/b&gt;&lt;br&gt;BÆ°á»›c: 2, 2.1, 2.2&lt;/td&gt;&lt;td&gt;User chÆ°a cÃ³ sáº£n pháº©m trong giá»&lt;br&gt;â†’ Tráº£ vá» lá»—i &quot;Cart is empty&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#fff2cc;&quot;&gt;&lt;b&gt;Ká»‹ch báº£n 2: CÃ³ sáº£n pháº©m háº¿t hÃ ng&lt;/b&gt;&lt;br&gt;BÆ°á»›c: 2.1, 2.2, 2.3&lt;/td&gt;&lt;td&gt;Má»™t hoáº·c nhiá»u sáº£n pháº©m khÃ´ng Ä‘á»§ tá»“n kho&lt;br&gt;â†’ Tráº£ vá» lá»—i &quot;Insufficient stock for product X&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#d5e8d4;&quot;&gt;&lt;b&gt;Ká»‹ch báº£n 3: Äáº·t hÃ ng thÃ nh cÃ´ng&lt;/b&gt;&lt;br&gt;BÆ°á»›c: 1, 2.1-2.9, 3&lt;/td&gt;&lt;td&gt;Giá» hÃ ng há»£p lá»‡ vÃ  Ä‘á»§ tá»“n kho&lt;br&gt;â†’ Táº¡o Ä‘Æ¡n hÃ ng â†’ Trá»« tá»“n kho â†’ Gá»­i email xÃ¡c nháº­n â†’ XÃ³a giá» hÃ ng&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="490" width="1320" height="160" as="geometry" />
        </mxCell>

        <!-- UC20: Xem Ä‘Æ¡n hÃ ng cá»§a tÃ´i -->
        <mxCell id="uc20-section" value="UC20: XEM ÄÆ N HÃ€NG Cá»¦A TÃ”I" style="rounded=1;whiteSpace=wrap;html=1;fontSize=18;fontStyle=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="680" width="1320" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="uc20-info" value="&lt;table border=&quot;1&quot; width=&quot;100%&quot; cellpadding=&quot;10&quot; style=&quot;border-collapse: collapse; font-size:13px;&quot;&gt;&lt;tr style=&quot;background-color:#f0f0f0;&quot;&gt;&lt;td width=&quot;25%&quot; style=&quot;font-weight:bold;&quot;&gt;Use case name&lt;/td&gt;&lt;td&gt;Xem Ä‘Æ¡n hÃ ng cá»§a tÃ´i&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#f0f0f0;font-weight:bold;&quot;&gt;Actors&lt;/td&gt;&lt;td&gt;KhÃ¡ch hÃ ng&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#f0f0f0;font-weight:bold;vertical-align:top;&quot;&gt;Flow&lt;/td&gt;&lt;td style=&quot;text-align:left;&quot;&gt;&lt;b&gt;1.&lt;/b&gt; VÃ o trang &quot;ÄÆ¡n hÃ ng cá»§a tÃ´i&quot;&lt;br&gt;&lt;b&gt;2.&lt;/b&gt; Há»‡ thá»‘ng láº¥y danh sÃ¡ch Ä‘Æ¡n hÃ ng&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.1 Truy váº¥n orders theo user_id&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.2 Sáº¯p xáº¿p theo thá»i gian (má»›i nháº¥t trÆ°á»›c)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;2.3 Load order_items cho má»—i Ä‘Æ¡n&lt;br&gt;&lt;b&gt;3.&lt;/b&gt; Hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n hÃ ng&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" style="text;html=1;strokeColor=#9673a6;fillColor=#e1d5e7;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="720" width="1320" height="160" as="geometry" />
        </mxCell>

        <mxCell id="uc20-scenarios-title" value="Ká»‹ch báº£n (Scenarios)" style="rounded=0;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="890" width="1320" height="30" as="geometry" />
        </mxCell>

        <mxCell id="uc20-scenarios" value="&lt;table border=&quot;1&quot; width=&quot;100%&quot; cellpadding=&quot;10&quot; style=&quot;border-collapse: collapse; font-size:13px;&quot;&gt;&lt;tr style=&quot;background-color:#d5e8d4;&quot;&gt;&lt;td width=&quot;30%&quot; style=&quot;font-weight:bold;&quot;&gt;Ká»‹ch báº£n&lt;/td&gt;&lt;td style=&quot;font-weight:bold;&quot;&gt;MÃ´ táº£&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#fff2cc;&quot;&gt;&lt;b&gt;Ká»‹ch báº£n 1: ChÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o&lt;/b&gt;&lt;br&gt;BÆ°á»›c: 2, 2.1&lt;/td&gt;&lt;td&gt;User chÆ°a tá»«ng Ä‘áº·t hÃ ng&lt;br&gt;â†’ Tráº£ vá» danh sÃ¡ch rá»—ng&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td style=&quot;background-color:#d5e8d4;&quot;&gt;&lt;b&gt;Ká»‹ch báº£n 2: CÃ³ Ä‘Æ¡n hÃ ng&lt;/b&gt;&lt;br&gt;BÆ°á»›c: 1, 2.1, 2.2, 2.3, 3&lt;/td&gt;&lt;td&gt;User Ä‘Ã£ cÃ³ Ä‘Æ¡n hÃ ng&lt;br&gt;â†’ Hiá»ƒn thá»‹ danh sÃ¡ch vá»›i tráº¡ng thÃ¡i vÃ  tá»•ng tiá»n&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" style="text;html=1;strokeColor=#82b366;fillColor=#d5e8d4;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="920" width="1320" height="120" as="geometry" />
        </mxCell>

        <!-- UC21-UC25 Summary -->
        <mxCell id="uc21-25-section" value="UC21-UC25: QUáº¢N LÃ ÄÆ N HÃ€NG CHI TIáº¾T" style="rounded=1;whiteSpace=wrap;html=1;fontSize=18;fontStyle=1;fillColor=#ffe6cc;strokeColor=#d79b00;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="1070" width="1320" height="40" as="geometry" />
        </mxCell>

        <mxCell id="uc21-detail" value="&lt;b&gt;UC21: XEM CHI TIáº¾T ÄÆ N HÃ€NG&lt;/b&gt;&lt;br&gt;â€¢ Actors: KhÃ¡ch hÃ ng, Quáº£n trá»‹ viÃªn&lt;br&gt;â€¢ Flow: Click vÃ o Ä‘Æ¡n hÃ ng â†’ Kiá»ƒm tra quyá»n xem â†’ Load order_items + user info â†’ TÃ­nh timeline (created, confirmed, shipped, delivered)&lt;br&gt;â€¢ Scenarios: ÄÆ¡n hÃ ng khÃ´ng tá»“n táº¡i | KhÃ´ng cÃ³ quyá»n xem | Xem thÃ nh cÃ´ng" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="40" y="1110" width="1320" height="90" as="geometry" />
        </mxCell>

        <mxCell id="uc22-detail" value="&lt;b&gt;UC22: Há»¦Y ÄÆ N HÃ€NG&lt;/b&gt;&lt;br&gt;â€¢ Actors: KhÃ¡ch hÃ ng&lt;br&gt;â€¢ Flow: Nháº¥n &quot;Há»§y Ä‘Æ¡n&quot; â†’ Kiá»ƒm tra tráº¡ng thÃ¡i (chá»‰ PENDING/CONFIRMED má»›i Ä‘Æ°á»£c há»§y) â†’ Cáº­p nháº­t status = CANCELLED â†’ HoÃ n tráº£ tá»“n kho â†’ Gá»­i email&lt;br&gt;â€¢ Scenarios: ÄÆ¡n hÃ ng khÃ´ng tá»“n táº¡i | ÄÆ¡n hÃ ng khÃ´ng thá»ƒ há»§y (Ä‘Ã£ ship) | Há»§y thÃ nh cÃ´ng" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="40" y="1200" width="1320" height="90" as="geometry" />
        </mxCell>

        <mxCell id="uc23-detail" value="&lt;b&gt;UC23: XEM Táº¤T Cáº¢ ÄÆ N HÃ€NG (Admin)&lt;/b&gt;&lt;br&gt;â€¢ Actors: Quáº£n trá»‹ viÃªn&lt;br&gt;â€¢ Flow: VÃ o trang quáº£n lÃ½ â†’ XÃ¡c thá»±c role = ADMIN â†’ Truy váº¥n táº¥t cáº£ orders â†’ Load user + order_items â†’ Há»— trá»£ lá»c theo tráº¡ng thÃ¡i&lt;br&gt;â€¢ Scenarios: KhÃ´ng cÃ³ quyá»n (403) | ChÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o | Xem thÃ nh cÃ´ng" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="40" y="1290" width="1320" height="90" as="geometry" />
        </mxCell>

        <mxCell id="uc24-detail" value="&lt;b&gt;UC24: Cáº¬P NHáº¬T TRáº NG THÃI ÄÆ N HÃ€NG (Admin)&lt;/b&gt;&lt;br&gt;â€¢ Actors: Quáº£n trá»‹ viÃªn&lt;br&gt;â€¢ Flow: Chá»n Ä‘Æ¡n hÃ ng + tráº¡ng thÃ¡i má»›i â†’ XÃ¡c thá»±c Admin â†’ Cáº­p nháº­t status â†’ LÆ°u timestamp (shipped_at, delivered_at) â†’ Gá»­i email (Observer)&lt;br&gt;â€¢ Scenarios: KhÃ´ng cÃ³ quyá»n (403) | Order khÃ´ng tá»“n táº¡i | Cáº­p nháº­t thÃ nh cÃ´ng" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="40" y="1380" width="1320" height="90" as="geometry" />
        </mxCell>

        <mxCell id="uc25-detail" value="&lt;b&gt;UC25: Cáº¬P NHáº¬T TRáº NG THÃI THANH TOÃN (Admin)&lt;/b&gt;&lt;br&gt;â€¢ Actors: Quáº£n trá»‹ viÃªn&lt;br&gt;â€¢ Flow: Chá»n Ä‘Æ¡n hÃ ng + tráº¡ng thÃ¡i thanh toÃ¡n â†’ XÃ¡c thá»±c Admin â†’ Validate (PENDING/PAID/FAILED) â†’ Cáº­p nháº­t payment_status â†’ LÆ°u paid_at&lt;br&gt;â€¢ Scenarios: KhÃ´ng cÃ³ quyá»n (403) | Order khÃ´ng tá»“n táº¡i | Tráº¡ng thÃ¡i khÃ´ng há»£p lá»‡ | Cáº­p nháº­t thÃ nh cÃ´ng" style="text;html=1;strokeColor=#d79b00;fillColor=#ffe6cc;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="40" y="1470" width="1320" height="90" as="geometry" />
        </mxCell>

        <mxCell id="note" value="ðŸ“„ Xem file USE_CASE_SPECIFICATIONS.md Ä‘á»ƒ cÃ³ chi tiáº¿t Ä‘áº§y Ä‘á»§ flows vÃ  scenarios cho UC21-UC25" style="text;html=1;strokeColor=#6c8ebf;fillColor=#dae8fc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="40" y="1580" width="1320" height="40" as="geometry" />
        </mxCell>

        <!-- Footer -->
        <mxCell id="footer" value="ðŸ“š AppleStore Backend | Order Management Use Cases: UC19-UC25 | 7/7 Complete âœ…" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=2;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="40" y="1650" width="1320" height="30" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>